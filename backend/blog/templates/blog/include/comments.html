{% load static %}

<!-- Discussion Section -->
<div>
    <!-- discussion header -->
    <div class="px-4 py-3 border-b border-gray-200 sm:px-6">
        <h3
                class="
                        text-xl
                        leading-6
                        font-medium
                        text-left text-gray-900
                      "
        >
                      <span class="inline-flex">
                        <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="h-6 w-6 text-gray-400"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                        >
                          <path
                                  stroke-linecap="round"
                                  stroke-linejoin="round"
                                  stroke-width="2"
                                  d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"></path>
                        </svg>
                        <span class="px-3">Discussion</span>
                      </span>
        </h3>
        <p class="text-sm text-gray-500">{{ post.comments.count }} comment{{ post.comments.count|pluralize }}</p>

        {% if not post.comments.all %}
            No comments yet
        {% endif %}
    </div>

    <form action="{% url 'blog:add-comment' post.slug %}" class="mt-8" method="post">
        {% csrf_token %}
        <h5 class="text-base mb-1">Comment:</h5>
        <input type="hidden" name="post_id" value="{{ post.slug }}">
        <input type="hidden" name="post_url" value="{{ post.get_absolute_url }}">
        <input type="hidden" name="post_author" value="{{ comment.author }}">
        <textarea
                type="text"
                class="
                                w-full
                                border border-gray-200
                                py-3
                                px-5
                                text-sm
                                rounded-sm
                                h-20
                                focus:outline-none focus:border-gray-400
                              "
                placeholder="type your comment"
        >{{ form.body }}</textarea>

        <div class="mt-2">
            <button
                    type="submit"
                    class="
                          text-white
                          py-1
                          px-3
                          rounded-md
                          uppercase
                          text-sm
                          bg-rose-500
                          border border-rose-500
                          hover:text-rose-500 hover:bg-transparent
                          transition
                        "
            >
                <span class="sr-only">Submit your Comment</span>
                Submit
            </button>
        </div>
    </form>


    <!-- discussion section card -->
    <div class="space-y-5 py-2">
        <!-- Comment block -->
        {% for comment in post.comments.all %}
            {% if user.is_authenticated or comment.active %}

                <div class="flex item-start border0b pb-5 border-gray-200">
                    <!-- comment author image -->
                    <div class="w-12 h-12 flex-shrink-0">
                        <img
                                src="{{ comment.author.profile_image.url }}"
                                alt="{{ comment.author }}"
                                class="w-full rounded-full"
                        />
                    </div>
                    <!-- Comment author name and datetime -->
                    <div class="flex-grow pl-4">
                        <h4 class="text-base font-roboto">{{ comment.author }}</h4>
                        <p class="text-xs text-gray-400">
                            {{ comment.created.date }}
                        </p>
                        <!-- Comment content text -->
                        <p class="text-sm font-600 mt-2">
                            {{ comment.body }}
                        </p>
                        <!-- Comment action buttons -->
                        <div class="flex gap-2 mt-2">
                            <a
                                    href="{% url 'blog:comment_remove' comment.id %}"
                                    class="
                              text-gray-500
                              px-2
                              text-xs
                              inline-flex
                              border border-gray-200
                              rounded-sm
                              shadow-sm
                              hover:bg-rose-600 hover:text-white
                              transition
                            "
                            >
                                <span class="sr-only">Delete comment</span>
                                <span>Delete</span>
                            </a>
                        </div>
                    </div>
                </div>

            {% endif %}
        {% endfor %}
    </div>


</div>

